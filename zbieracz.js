const fs = require("fs");
const { parse } = require("csv-parse");
const scrapingbee = require("scrapingbee");

const mongoose = require("mongoose");
const util = require("util");

dotenv.config();
const APIKEY = process.env.API_KEY;

const schema = {
  promoklocki: {
    ref: "h1 span.text-success",
    link: {
      selector: ".col-8.col-md-7.col-lg-8.align-self-center.text-left a",
      output: "@href",
    },
  },
};

let errorsCount = 0;

// const refs = [
// 	['6949317',	'41441'],
// 	['6029961',	'31058'],
// 	['6835708',	'60287'],
// 	['6597931',	'10929'],
// 	['6857417',	'42120'],
// 	['6835691',	'10955'],
// 	['7091962',	'60348'],
// 	['6857399',	'10949'],
// 	['6949200',	'10954'],
// 	['7130948',	'42136'],
// 	['6835717',	'10281'],
// 	['6835750',	'42123'],
// 	['6835704',	'60283'],
// 	['6835735',	'21164'],
// 	['6835722',	'41439'],
// 	['7089245',	'10965'],
// 	['6835747',	'42118'],
// 	['7089249',	'21178'],
// 	['7089250',	'21179'],
// 	['6949371',	'76900'],
// 	['5725436',	'10696'],
// 	['6835716',	'10280'],
// 	['6949202',	'10945'],
// 	['6835690',	'10953'],
// 	['7089269',	'42134'],
// 	['6835724',	'41444'],
// 	['6857398',	'10950'],
// 	['6677628',	'10931'],
// 	['6835726',	'41449'],
// 	['6597121',	'60253'],
// 	['6835723',	'41443'],
// 	['6835718',	'31111'],
// 	['6949372',	'76901'],
// 	['7089270',	'42135'],
// 	['6949203',	'10946'],
// 	['6949505',	'76386'],
// 	['6597275',	'10913'],
// 	['5725445',	'10698'],
// 	['7147551',	'41696'],
// 	['7147552',	'41719'],
// 	['7147575',	'60346'],
// 	['7089281',	'60319'],
// 	['6840723',	'21167'],
// 	['7089268',	'42132'],
// 	['6835694',	'76383'],
// 	['6835696',	'76385'],
// 	['6835693',	'76382'],
// 	['6949323',	'41677'],
// 	['6835714',	'60304'],
// 	['6835746',	'42117'],
// 	['7089252',	'21181'],
// 	['7147596',	'41715'],
// 	['7089248',	'21177'],
// 	['6597984',	'21158'],
// 	['6835699',	'60277'],
// 	['7089503',	'10311'],
// 	['7089279',	'60316'],
// 	['7242946',	'76912'],
// 	['7089272',	'42138'],
// 	['6857429',	'10951'],
// 	['7147581',	'41716'],
// 	['6835698',	'60276'],
// 	['6835736',	'21170'],
// 	['6870917',	'60305'],
// 	['6397370',	'31088'],
// 	['6598005',	'41395'],
// 	['6597277',	'10915'],
// 	['6598591',	'71700'],
// 	['6949378',	'21172'],
// 	['7089286',	'60324'],
// 	['7147574',	'41717'],
// 	['6597122',	'60243'],
// 	['7147550',	'41705'],
// 	['7091727',	'10938'],
// 	['7147592',	'21184'],
// 	['7147590',	'41710'],
// 	['6949373',	'76902'],
// 	['6857422',	'31116'],
// 	['7147591',	'60355'],
// 	['6835745',	'42116'],
// 	['7091730',	'76396'],
// 	['7147588',	'60354'],
// 	['7091731',	'76397'],
// 	['6835697',	'60275'],
// 	['6835748',	'42119'],
// 	['7189314',	'60332'],
// 	['7089251',	'21180'],
// 	['7189313',	'60331'],
// 	['7147582',	'10977'],
// 	['7147554',	'10971'],
// 	['6268748',	'10874'],
// 	['7147595',	'41712'],
// 	['6677627',	'10930'],
// 	['6597929',	'10909'],
// 	['7147583',	'21185'],
// 	['6949360',	'21171'],
// 	['6949374',	'76903'],
// 	['6597930',	'10914'],
// 	['7242947',	'76911'],
// 	['7089271',	'42137'],
// 	['6949324',	'41679'],
// 	['6949208',	'60300'],
// 	['7147587',	'60353'],
// 	['7091838',	'76908'],
// 	['7091845',	'76207'],
// 	['7167073',	'41713'],
// 	['7147594',	'10972'],
// 	['6949334',	'10772'],
// 	['6835705',	'60284'],
// 	['7089259',	'41703'],
// 	['6857405',	'21168'],
// 	['7089501',	'42141'],
// 	['7091725',	'10980'],
// 	['7147577',	'10973'],
// 	['6725782',	'75280'],
// 	['6400542',	'60205'],
// 	['6597989',	'31100'],
// 	['6835702',	'60281'],
// 	['7253708',	'10302'],
// 	['7089278',	'60315'],
// 	['6724474',	'71360'],
// 	['7147548',	'60341'],
// 	['7147586',	'60345'],
// 	['7147555',	'60337'],
// 	['7090424',	'60336'],
// 	['7089254',	'31129'],
// 	['6689745',	'42107'],
// 	['6959118',	'41693'],
// 	['6835715',	'11013'],
// 	['7147568',	'60347'],
// 	['6598003',	'41393'],
// 	['7090426',	'21331'],
// 	['7291808',	'41706'],
// 	['7147576',	'10963'],
// 	['7147567',	'41708'],
// 	['6949506',	'76387'],
// 	['7091841',	'75329'],
// 	['7089306',	'75320'],
// 	['7291810',	'60352'],
// 	['7091748',	'11021'],
// 	['7091734',	'10298'],
// 	['7089284',	'60322'],
// 	['7147549',	'60340'],
// 	['7089240',	'10782'],
// 	['7147570',	'41720'],
// 	['7091761',	'76831'],
// 	['7147597',	'60342'],
// 	['7089239',	'10781'],
// 	['7089300',	'71761'],
// 	['7089276',	'60312'],
// 	['7091735',	'76943'],
// 	['7089496',	'10969'],
// 	['7089310',	'76181'],
// 	['6857414',	'76175'],
// 	['7009150',	'60299'],
// 	['7091849',	'75330'],
// 	['7089273',	'43198'],
// 	['7147579',	'71759'],
// 	['7256156',	'41963'],
// 	['7089505',	'42139'],
// 	['7091742',	'11023'],
// 	['7147557',	'21188'],
// 	['7091737',	'76946'],
// 	['7089242',	'10784'],
// 	['7189325',	'41954'],
// 	['6835719',	'31113'],
// 	['7147569',	'71772'],
// 	['7091840',	'75324'],
// 	['6949196',	'41937'],
// 	['7089312',	'76202'],
// 	['6725229',	'75317'],
// 	['7189315',	'60338'],
// 	['7189311',	'41960'],
// 	['7089282',	'60320'],
// 	['6840725',	'21165'],
// 	['6949325',	'41681'],
// 	['7089241',	'10783'],
// 	['6835687',	'41926'],
// 	['7291813',	'76404'],
// 	['7089491',	'41718'],
// 	['7091844',	'76212'],
// 	['7291856',	'75571'],
// 	['7147566',	'41711'],
// 	['6981304',	'75312'],
// 	['7089486',	'41694'],
// 	['7089309',	'76179'],
// 	['6949364',	'21176'],
// 	['7089293',	'71397'],
// 	['7147593',	'76400'],
// 	['7253705',	'42145'],
// 	['7091726',	'10962'],
// 	['6400546',	'60238'],
// 	['7253709',	'75333'],
// 	['7253715',	'71404'],
// 	['7091836',	'76906'],
// 	['7242945',	'21189'],
// 	['7091751',	'31125'],
// 	['6949209',	'60301'],
// 	['6373627',	'75955'],
// 	['7091744',	'11026'],
// 	['7253713',	'75323'],
// 	['7253711',	'42143'],
// 	['7090425',	'75343'],
// 	['6835680',	'43189'],
// 	['7089244',	'10964'],
// 	['7091837',	'76907'],
// 	['7147560',	'41714'],
// 	['6677605',	'60262'],
// 	['7089301',	'71762'],
// 	['6949207',	'10961'],
// 	['7189320',	'10974'],
// 	['7147558',	'31132'],
// 	['6949331',	'41687'],
// 	['7089287',	'60325'],
// 	['7091738',	'76944'],
// 	['7091743',	'11025'],
// 	['6870916',	'10934'],
// 	['7089308',	'75322'],
// 	['7147573',	'76401'],
// 	['7091752',	'31126'],
// 	['7089289',	'60329'],
// 	['6949376',	'76186'],
// 	['6950561',	'76191'],
// 	['6857400',	'41450'],
// 	['7091736',	'76945'],
// 	['7242948',	'21190'],
// 	['7089487',	'42133'],
// 	['7089257',	'41701'],
// 	['7089255',	'41695'],
// 	['7091739',	'76947'],
// 	['6949367',	'71754'],
// 	['7009152',	'60298'],
// 	['6268749',	'10875'],
// 	['7089488',	'10959'],
// 	['7091839',	'76910'],
// 	['6837331',	'75301'],
// 	['7089316',	'76206'],
// 	['7089260',	'41704'],
// 	['7091732',	'76398'],
// 	['7091961',	'60349'],
// 	['7128129',	'11012'],
// 	['6597934',	'11008'],
// 	['6689751',	'75968'],
// 	['7147580',	'71769'],
// 	['6949327',	'41683'],
// 	['7089274',	'43199'],
// 	['6857410',	'71745'],
// 	['7091759',	'71764'],
// 	['7089299',	'71760'],
// 	['7147553',	'60344'],
// 	['7291857',	'75572'],
// 	['7091750',	'31128'],
// 	['6857409',	'71740'],
// 	['7089313',	'76203'],
// 	['7089285',	'60323'],
// 	['7089314',	'76204'],
// 	['7089490',	'41709'],
// 	['7089504',	'43209'],
// 	['7253243',	'71405'],
// 	['7091963',	'60350'],
// 	['6949501',	'42128'],
// 	['6857416',	'42121'],
// 	['7147571',	'21186'],
// 	['7256160',	'71409'],
// 	['6689747',	'75969'],
// 	['7147585',	'41957'],
// 	['7253244',	'71403'],
// 	['6949197',	'41938'],
// 	['7091729',	'76989'],
// 	['7089298',	'71757'],
// 	['6949328',	'41684'],
// 	['7016606',	'60296'],
// 	['7089256',	'41700'],
// 	['7253716',	'71406'],
// 	['6993505',	'76940'],
// 	['7091753',	'31127'],
// 	['6949318',	'71387'],
// 	['7091756',	'70688'],
// 	['7089267',	'42127'],
// 	['7291804',	'76225'],
// 	['7089246',	'10966'],
// 	['7089296',	'71400'],
// 	['6933265',	'21326'],
// 	['7089494',	'75327'],
// 	['7089261',	'41707'],
// 	['7089247',	'21057'],
// 	['6949337',	'10776'],
// 	['6835703',	'60282'],
// 	['6397362',	'21044'],
// 	['6116934',	'17101'],
// 	['7091749',	'31124'],
// 	['7089292',	'71396'],
// 	['7089264',	'41944'],
// 	['7147584',	'43204'],
// 	['7089266',	'41948'],
// 	['7147563',	'76402'],
// 	['6949332',	'41688'],
// 	['6949205',	'10948'],
// 	['6677606',	'31109'],
// 	['7147589',	'71770'],
// 	['7189321',	'10975'],
// 	['7089489',	'41952'],
// 	['7091733',	'76399'],
// 	['7089303',	'71765'],
// 	['7089307',	'75321'],
// 	['7089295',	'71399'],
// 	['6549922',	'41166'],
// 	['7089253',	'21183'],
// 	['7291811',	'76230'],
// 	['7253707',	'41947'],
// 	['6837323',	'75299'],
// 	['6725790',	'42114'],
// 	['6933258',	'10275'],
// 	['7091740',	'76948'],
// 	['7016605',	'76195'],
// 	['7253706',	'42144'],
// 	['6974691',	'71391'],
// 	['7089265',	'41946'],
// 	['7147561',	'76403'],
// 	['7291858',	'75573'],
// 	['6497760',	'10899'],
// 	['6857412',	'75297'],
// 	['7091846',	'76213'],
// 	['7253710',	'75334'],
// 	['7089498',	'42140'],
// 	['7089493',	'75328'],
// 	['7147578',	'31131'],
// 	['7089288',	'60328'],
// 	['6835751',	'42124'],
// 	['7291802',	'75340'],
// 	['7291805',	'76226'],
// 	['6949191',	'43194'],
// 	['7089243',	'10960'],
// 	['6837322',	'75295'],
// 	['6933264',	'21325'],
// 	['6949507',	'76388'],
// 	['7089294',	'71398'],
// 	['6835752',	'42125'],
// 	['7009148',	'60293'],
// 	['6840722',	'92176'],
// 	['7292412',	'21333'],
// 	['7147556',	'71774'],
// 	['7089275',	'43208'],
// 	['6835682',	'43192'],
// 	['7256155',	'76218'],
// 	['7091760',	'76830'],
// 	['6636742',	'10265'],
// 	['7089258',	'41702'],
// 	['7091724',	'76832'],
// 	['7091960',	'42130'],
// 	['6835725',	'41448'],
// 	['6933259',	'10278'],
// 	['6996847',	'43193'],
// 	['6835749',	'42122'],
// 	['7089311',	'76183'],
// 	['6949193',	'41932'],
// 	['7189322',	'21058'],
// 	['7016608',	'60309'],
// 	['6835720',	'31114'],
// 	['6837324',	'75300'],
// 	['6949508',	'76389'],
// 	['7089302',	'71763'],
// 	['6943458',	'75305'],
// 	['6933260',	'10283'],
// 	['7016609',	'60311'],
// 	['7016603',	'76240'],
// 	['7091723',	'31205'],
// 	['7090421',	'43203'],
// 	['6725791',	'42115'],
// 	['7089283',	'60321'],
// 	['7147559',	'71775'],
// 	['7291859',	'75574'],
// 	['6555949',	'42110'],
// 	['7089502',	'10968'],
// 	['7189312',	'43206'],
// 	['7253717',	'75336'],
// 	['7089290',	'60330'],
// 	['6981306',	'75310'],
// 	['7089315',	'76205'],
// 	['7189316',	'60339'],
// 	['6268803',	'60198'],
// 	['7089506',	'10967'],
// 	['7091741',	'76949'],
// 	['6949194',	'41935'],
// 	['6636741',	'21321'],
// 	['7089277',	'60314'],
// 	['6636743',	'10266'],
// 	['6868464',	'76161'],
// 	['7091847',	'76208'],
// 	['6949204',	'10947'],
// 	['6933261',	'10295'],
// 	['7256157',	'41964'],
// 	['7189310',	'76216'],
// 	['6677634',	'21054'],
// 	['7091758',	'70690'],
// 	['7089304',	'71766'],
// 	['7016607',	'60310'],
// 	['6949509',	'42129'],
// 	['7009153',	'60295'],
// 	['6213153',	'75192'],
// 	['7089291',	'60343'],
// 	['6949190',	'71749'],
// 	['7009149',	'60294'],
// 	['7089557',	'43202'],
// 	['6835743',	'71737'],
// 	['7089492',	'41949'],
// 	['7016616',	'42131'],
// 	['7091747',	'11019'],
// 	['6950562',	'76193'],
// 	['7089297',	'71401'],
// 	['7256161',	'71407'],
// 	['6981305',	'76194'],
// 	['6677630',	'10933'],
// 	['7016602',	'10282'],
// 	['7089497',	'41951'],
// 	['6949206',	'10956'],
// 	['7089226',	'43200'],
// 	['6554783',	'41168'],
// 	['7091745',	'11024'],
// 	['6725787',	'31197'],
// 	['7256159',	'71408'],
// 	['7089280',	'60317'],
// 	['6725786',	'75288'],
// 	['7091757',	'70689'],
// 	['7009151',	'60297'],
// 	['6636740',	'10271'],
// 	['6636754',	'21318'],
// 	['7089305',	'71767'],
// 	['6949375',	'76904'],
// 	['6949336',	'10774'],
// 	['6949329',	'41685'],
// 	['6840721',	'75318'],
// 	['7091762',	'41950'],
// 	['6353635',	'42083'],
// 	['7246313',	'43205'],
// 	['6835677',	'31201'],
// 	['7253714',	'71410'],
// 	['7089499',	'43207'],
// 	['7304229',	'71411'],
// 	['7089500',	'10970'],
// 	['6993502',	'76942'],
// 	['7089263',	'41943'],
// 	['7016615',	'76184'],
// 	['7091842',	'71402'],
// 	['6681176',	'42111'],
// 	['6974692',	'71390'],
// 	['7091746',	'11018'],
// 	['6636745',	'10270'],
// 	['6996845',	'43195'],
// 	['6868463',	'71741'],
// 	['6933257',	'10274'],
// 	['7253712',	'75337'],
// 	['6636748',	'75252'],
// 	['6996844',	'43197'],
// 	['6597935',	'11010'],
// 	['6170327',	'10714'],
// 	['6949210',	'60302'],
// 	['6835712',	'60291'],
// 	['6857396',	'10952'],
// 	['7091843',	'75326'],
// 	['6857411',	'75302'],
// 	['7016612',	'76155'],
// 	['6835721',	'31118'],
// 	['6949361',	'76190'],
// 	['7189309',	'41956'],
// 	['7189323',	'31206'],
// 	['7189324',	'41953'],
// 	['7016614',	'76154'],
// 	['6213148',	'10255'],
// 	['7147572',	'76217'],
// 	['6949333',	'41689'],
// 	['6724477',	'71368'],
// 	['7189326',	'41955'],
// 	['6949330',	'41686'],
// 	['6397407',	'42096'],
// 	['6974697',	'71388'],
// 	['6835678',	'31202'],
// 	['7147562',	'71773'],
// 	['6868462',	'71374'],
// 	['6949363',	'21174'],
// 	['6974696',	'71393'],
// 	['6857421',	'11014'],
// 	['6835742',	'71736'],
// 	['7091755',	'71033'],
// 	['6949192',	'43196'],
// 	['6411249',	'71043'],
// 	['7043336',	'76145'],
// 	['6857419',	'43185'],
// 	['6949326',	'41682'],
// 	['7016604',	'42126'],
// 	['7256158',	'31207'],
// 	['7091754',	'71032'],
// 	['6471362',	'76137'],
// 	['7016611',	'76156'],
// 	['6029965',	'60139'],
// 	['6949377',	'76189'],
// 	['6857406',	'71748'],
// 	['6949369',	'71755'],
// 	['6836085',	'71380'],
// 	['6597126',	'60251'],
// 	['6875277',	'41931'],
// 	['6471417',	'75948'],
// 	['5891197',	'21028'],
// 	['6724475',	'71365'],
// 	['6949195',	'41936'],
// 	['6268746',	'10872'],
// 	['6933266',	'43179'],
// 	['6949370',	'71756'],
// 	['6857418',	'43181'],
// 	['6974695',	'71392'],
// 	['7089495',	'41699'],
// 	['7016618',	'76185'],
// 	['6857423',	'31115'],
// 	['6170326',	'10713'],
// 	['7189319',	'10780'],
// 	['6622675',	'41254'],
// 	['6870918',	'11011'],
// 	['6597279',	'10920'],
// 	['6949211',	'11015'],
// 	['7089262',	'41942'],
// 	['6029708',	'10847'],
// 	['6397468',	'75891'],
// 	['6397369',	'31087'],
// 	['6397435',	'70665'],
// 	['6835713',	'60292'],
// 	['7291806',	'76231'],
// 	['6089609',	'10840'],
// 	['6397416',	'60215'],
// 	['6840724',	'21166'],
// 	['6268802',	'60197'],
// 	['6397399',	'42088'],
// 	['6397415',	'60214'],
// 	['6397427',	'60239'],
// 	['6397469',	'75892'],
// 	['6411228',	'10887'],
// 	['6411242',	'60229'],
// 	['6597118',	'60247'],
// 	['6857407',	'71747'],
// 	['6598009',	'41394'],
// 	['6163490',	'10870'],
// 	['6170537',	'41340'],
// 	['6397374',	'31092'],
// 	['6397401',	'42090'],
// 	['6471328',	'60224'],
// 	['6600369',	'76895'],
// 	['6657155',	'75550'],
// 	['6677629',	'10932'],
// 	['6993506',	'76390']
// ];

// const refs = [
//   ["7376276", "10986"],
//   ["7376297", "42149"],
//   ["7376337", "76245"],
//   ["7376266", "60358"],
//   ["7376312", "10995"],
//   ["7376279", "60375"],
//   ["7376321", "75575"],
//   ["7376302", "60384"],
//   ["7376290", "71781"],
//   ["7376267", "41738"],
//   ["7376326", "71413"],
//   ["7376271", "41732"],
//   ["7376353", "41802"],
//   ["7376278", "60373"],
//   ["7376261", "60385"],
//   ["7376352", "41806"],
//   ["7376350", "21240"],
//   ["7376305", "60372"],
//   ["7376355", "31133"],
//   ["7376351", "43214"],
//   ["7376296", "41735"],
//   ["7376338", "76247"],
//   ["7376269", "41741"],
//   ["7376288", "71780"],
//   ["7376333", "76215"],
//   ["7376314", "41724"],
//   ["7376257", "60356"],
//   ["7376335", "76243"],
//   ["7376263", "41805"],
//   ["7376259", "42151"],
//   ["7376344", "75345"],
//   ["7376343", "75344"],
//   ["7376254", "60393"],
//   ["7376357", "71786"],
//   ["7376273", "60383"],
//   ["7376298", "42150"],
//   ["7376322", "75576"],
//   ["7376268", "41727"],
//   ["7376283", "41731"],
//   ["7376272", "42147"],
//   ["7376299", "41801"],
//   ["7376282", "41728"],
//   ["7376356", "10985"],
//   ["7376285", "71784"],
//   ["7376289", "10996"],
//   ["7376349", "21242"],
//   ["7376286", "71785"],
//   ["7376281", "41743"],
//   ["7376324", "75578"],
//   ["7376258", "41807"],
//   ["7376294", "41733"],
//   ["7376340", "21243"],
//   ["7376311", "42148"],
//   ["7376342", "21244"],
//   ["7376329", "71416"],
//   ["7376295", "60369"],
//   ["7376274", "60371"],
//   ["7376284", "41726"],
//   ["7376331", "71418"],
//   ["7376354", "60382"],
//   ["7376304", "60370"],
//   ["7376262", "10990"],
//   ["7376317", "41739"],
//   ["7376265", "60389"],
//   ["7376292", "10303"],
//   ["7376315", "31208"],
//   ["7376287", "71783"],
//   ["7376330", "71417"],
//   ["7376318", "41740"],
//   ["7376345", "75347"],
//   ["7376327", "71414"],
//   ["7376328", "71415"],
//   ["7376270", "41723"],
//   ["7376332", "76241"],
//   ["7376308", "60386"],
//   ["7376300", "41729"],
//   ["7376334", "76242"],
//   ["7376336", "76244"],
//   ["7376313", "41730"],
//   ["7376319", "41754"],
//   ["7376325", "75579"],
//   ["7376341", "21245"],
//   ["7376310", "41751"],
//   ["7376291", "71788"],
//   ["7376320", "41755"],
//   ["7376255", "60387"],
//   ["7376339", "76248"],
//   ["7376303", "60392"],
//   ["7376307", "43216"],
//   ["7376280", "60388"],
//   ["7376347", "21241"],
//   ["7376293", "43210"],
//   ["7376301", "60390"],
//   ["7376277", "60374"],
//   ["7376256", "43211"],
//   ["7376275", "41803"],
//   ["7376346", "76917"],
//   ["7376264", "71787"],
//   ["7376260", "71782"],
//   ["7376323", "75577"],
//   ["7376348", "21246"],
//   ["7405534", "10314"],
//   ["7405479", "10313"],
// ];

const refs = [
  ["5725436", "10696"],
  ["5725445", "10698"],
  ["5891197", "21028"],
  ["6029787", "21034"],
  ["6029961", "31058"],
  ["6170326", "10713"],
  ["6268753", "21042"],
  ["6268746", "10872"],
  ["6268748", "10874"],
  ["6268749", "10875"],
  ["6268751", "10882"],
  ["6400542", "60205"],
  ["6400546", "60238"],
  ["6268803", "60198"],
  ["6397370", "31088"],
  ["6397362", "21044"],
  ["6497760", "10899"],
  ["6554783", "41168"],
  ["6555950", "75257"],
  ["6597275", "10913"],
  ["6597930", "10914"],
  ["6597121", "60253"],
  ["6597929", "10909"],
  ["6681176", "42111"],
  // ["#N/D", "88006"],
  // ["#N/D", "88005"],
  // ["#N/D", "88007"],
  // ["#N/D", "88008"],
  // ["#N/D", "88009"],
  // ["#N/D", "88010"],
  // ["#N/D", "88011"],
  ["6677627", "10930"],
  ["6677628", "10931"],
  ["6677634", "21054"],
  ["6677606", "31109"],
  ["6689745", "42107"],
  ["6689751", "75968"],
  // ["#N/D", "88013"],
  // ["#N/D", "88012"],
  ["6725791", "42115"],
  ["6724474", "71360"],
  ["6725229", "75317"],
  ["6757623", "43187"],
  ["6840721", "75318"],
  ["6840724", "21166"],
  ["6835715", "11013"],
  ["6835718", "31111"],
  ["6835721", "31118"],
  ["6835744", "71738"],
  ["6835704", "60283"],
  ["6835708", "60287"],
  ["6835746", "42117"],
  ["6835747", "42118"],
  ["6835680", "43189"],
  ["6835689", "10941"],
  ["6835691", "10955"],
  ["6835714", "60304"],
  ["6835749", "42122"],
  ["6835750", "42123"],
  ["6835752", "42125"],
  ["6835735", "21164"],
  ["6835736", "21170"],
  ["6835723", "41443"],
  ["6835716", "10280"],
  ["6835717", "10281"],
  ["6837331", "75301"],
  // ["#N/D", "88015"],
  ["6933257", "10274"],
  ["6857421", "11014"],
  ["6857399", "10949"],
  ["6943456", "76187"],
  ["6943457", "75304"],
  ["6943452", "10944"],
  ["6949191", "43194"],
  ["6949200", "10954"],
  ["6949205", "10948"],
  ["6949206", "10956"],
  ["6949371", "76900"],
  ["6949372", "76901"],
  ["6949367", "71754"],
  ["6949370", "71756"],
  ["6950561", "76191"],
  ["6950562", "76193"],
  ["6949505", "76386"],
  ["6949507", "76388"],
  ["6949508", "76389"],
  ["6949378", "21172"],
  ["6949323", "41677"],
  ["6949192", "43196"],
  ["6949318", "71387"],
  ["6949501", "42128"],
  ["6981304", "75312"],
  ["6949509", "42129"],
  ["7016616", "42131"],
  ["7016603", "76240"],
  ["7089557", "43202"],
  ["7089310", "76181"],
  ["7089267", "42127"],
  ["7089268", "42132"],
  ["7089284", "60322"],
  ["7089285", "60323"],
  ["7089286", "60324"],
  ["7089299", "71760"],
  ["7089300", "71761"],
  ["7089301", "71762"],
  ["7089302", "71763"],
  ["7089239", "10781"],
  ["7089240", "10782"],
  ["7089242", "10784"],
  ["7089298", "71757"],
  ["7089303", "71765"],
  ["7089304", "71766"],
  ["7089305", "71767"],
  ["7089306", "75320"],
  ["7089316", "76206"],
  ["7089273", "43198"],
  ["7089274", "43199"],
  ["7089275", "43208"],
  ["7089266", "41948"],
  // ["#N/D", "41697"],
  ["7089259", "41703"],
  ["7089260", "41704"],
  ["7089261", "41707"],
  ["7089243", "10960"],
  ["7089244", "10964"],
  ["7089245", "10965"],
  ["7089246", "10966"],
  ["7089269", "42134"],
  ["7089270", "42135"],
  ["7089271", "42137"],
  ["7089272", "42138"],
  ["7089248", "21177"],
  ["7089249", "21178"],
  ["7089250", "21179"],
  ["7089251", "21180"],
  ["7089252", "21181"],
  ["7089253", "21183"],
  ["7089276", "60312"],
  ["7089277", "60314"],
  ["7089278", "60315"],
  ["7089279", "60316"],
  ["7089280", "60317"],
  // ["#N/D", "60318"],
  ["7089281", "60319"],
  ["7089282", "60320"],
  ["7089283", "60321"],
  ["7089287", "60325"],
  ["7089290", "60330"],
  ["7089291", "60343"],
  ["7089247", "21057"],
  ["7089254", "31129"],
  ["7091960", "42130"],
  // ["#N/D", "11017"],
  ["7089487", "42133"],
  ["7091746", "11018"],
  ["7091747", "11019"],
  // ["#N/D", "31123"],
  ["7091749", "31124"],
  ["7091751", "31125"],
  ["7091752", "31126"],
  ["7091753", "31127"],
  ["7091750", "31128"],
  ["7089505", "42139"],
  ["7091836", "76906"],
  ["7091840", "75324"],
  ["7091843", "75326"],
  ["7089494", "75327"],
  ["7089493", "75328"],
  ["7091732", "76398"],
  ["7091733", "76399"],
  ["7089499", "43207"],
  ["7089504", "43209"],
  ["7091762", "41950"],
  ["7089497", "41951"],
  ["7089495", "41699"],
  ["7089491", "41718"],
  ["7089488", "10959"],
  ["7089506", "10967"],
  ["7089502", "10968"],
  ["7089500", "10970"],
  ["7130948", "42136"],
  ["7089498", "42140"],
  ["7089501", "42141"],
  ["7091962", "60348"],
  ["7091961", "60349"],
  ["7091963", "60350"],
  // ["#N/D", "60351"],
  ["7091837", "76907"],
  ["7091838", "76908"],
  ["7091839", "76910"],
  ["7091734", "10298"],
  ["7091723", "31205"],
  ["7091742", "11023"],
  ["7091745", "11024"],
  ["7091743", "11025"],
  ["7091744", "11026"],
  ["7091725", "10980"],
  ["7090426", "21331"],
  ["7091727", "10938"],
  ["7091735", "76943"],
  ["7091738", "76944"],
  ["7091736", "76945"],
  ["7091737", "76946"],
  ["7091739", "76947"],
  ["7091740", "76948"],
  ["7091741", "76949"],
  // ["#N/D", "76951"],
  ["7091726", "10962"],
  ["7091760", "76830"],
  ["7091761", "76831"],
  ["7091724", "76832"],
  ["7091841", "75329"],
  ["7091849", "75330"],
  ["7091845", "76207"],
  ["7091847", "76208"],
  ["7167073", "41713"],
  ["7091729", "76989"],
  ["7091748", "11021"],
  ["7089503", "10311"],
  ["7147579", "71759"],
  ["7431793", "71768"],
  ["7147580", "71769"],
  ["7147589", "71770"],
  ["7147565", "71771"],
  ["7147569", "71772"],
  ["7147562", "71773"],
  ["7147556", "71774"],
  ["7147559", "71775"],
  // ["#N/D", "75325"],
  ["7189310", "76216"],
  ["7147572", "76217"],
  ["7147593", "76400"],
  ["7147573", "76401"],
  ["7147563", "76402"],
  ["7147561", "76403"],
  ["7147584", "43204"],
  ["7189312", "43206"],
  ["7147585", "41957"],
  ["7189327", "41959"],
  ["7189360", "41960"],
  ["7147551", "41696"],
  ["7147550", "41705"],
  ["7147567", "41708"],
  ["7147566", "41711"],
  ["7147595", "41712"],
  ["7147560", "41714"],
  ["7147596", "41715"],
  ["7147581", "41716"],
  ["7147574", "41717"],
  ["7147552", "41719"],
  ["7147570", "41720"],
  ["7147576", "10963"],
  ["7147554", "10971"],
  ["7147594", "10972"],
  ["7147577", "10973"],
  ["7189351", "10974"],
  ["7189321", "10975"],
  ["7147582", "10977"],
  ["7147592", "21184"],
  ["7147583", "21185"],
  ["7147571", "21186"],
  ["7147557", "21188"],
  ["7189363", "60332"],
  // ["#N/D", "60333"],
  ["7147555", "60337"],
  ["7189364", "60338"],
  ["7189365", "60339"],
  ["7147548", "60341"],
  ["7147597", "60342"],
  ["7147575", "60346"],
  ["7189317", "10777"],
  ["7189319", "10780"],
  ["7189322", "21058"],
  ["7147578", "31131"],
  ["7147558", "31132"],
  ["7189323", "31206"],
  ["7147587", "60353"],
  ["7147588", "60354"],
  ["7147591", "60355"],
  ["7431803", "76406"],
  ["7147564", "76407"],
  ["7246313", "43205"],
  ["7253713", "75323"],
  // ["#N/D", "75332"],
  ["7253709", "75333"],
  ["7253710", "75334"],
  // ["#N/D", "75335"],
  ["7253717", "75336"],
  ["7253712", "75337"],
  ["7256155", "76218"],
  ["7253707", "41947"],
  ["7256156", "41963"],
  ["7256157", "41964"],
  ["7089496", "10969"],
  ["7253711", "42143"],
  ["7253706", "42144"],
  ["7253705", "42145"],
  ["7253244", "71403"],
  ["7253715", "71404"],
  ["7253716", "71406"],
  ["7256161", "71407"],
  ["7256159", "71408"],
  ["7256160", "71409"],
  ["7253708", "10302"],
  ["7256158", "31207"],
  ["7242945", "21189"],
  ["7242948", "21190"],
  ["7242947", "76911"],
  ["7242946", "76912"],
  ["7291804", "76225"],
  ["7291805", "76226"],
  ["7291809", "10976"],
  // ["#N/D", "76220"],
  ["7291811", "76230"],
  ["7291856", "75571"],
  ["7291857", "75572"],
  ["7291858", "75573"],
  ["7291859", "75574"],
  ["7091848", "76211"],
  ["7091844", "76212"],
  ["7091846", "76213"],
  ["7304229", "71411"],
  ["7376340", "21243"],
  ["7376270", "41723"],
  ["7376294", "41733"],
  ["7376299", "41801"],
  ["7376353", "41802"],
  ["7376272", "42147"],
  ["7376311", "42148"],
  ["7376297", "42149"],
  ["7376298", "42150"],
  ["7376354", "60382"],
  ["7376273", "60383"],
  ["7376302", "60384"],
  ["7376327", "71414"],
  ["7376329", "71416"],
  ["7376288", "71780"],
  ["7376290", "71781"],
  ["7376260", "71782"],
  ["7376291", "71788"],
  ["7376314", "41724"],
  ["7376350", "21240"],
  ["7376347", "21241"],
  ["7376349", "21242"],
  ["7376342", "21244"],
  ["7376341", "21245"],
  ["7376355", "31133"],
  ["7376315", "31208"],
  ["7376284", "41726"],
  ["7376268", "41727"],
  ["7376282", "41728"],
  ["7376300", "41729"],
  ["7376313", "41730"],
  ["7376296", "41735"],
  ["7376267", "41738"],
  ["7376317", "41739"],
  ["7376318", "41740"],
  ["7376269", "41741"],
  ["7376310", "41751"],
  ["7376319", "41754"],
  ["7376320", "41755"],
  ["7376275", "41803"],
  ["7376263", "41805"],
  ["7376258", "41807"],
  ["7376259", "42151"],
  ["7376257", "60356"],
  ["7376266", "60358"],
  ["7376295", "60369"],
  ["7376304", "60370"],
  ["7376274", "60371"],
  ["7376305", "60372"],
  ["7376278", "60373"],
  ["7376277", "60374"],
  ["7376279", "60375"],
  ["7376261", "60385"],
  ["7376308", "60386"],
  ["7376255", "60387"],
  ["7376280", "60388"],
  ["7376265", "60389"],
  ["7376301", "60390"],
  ["7376303", "60392"],
  ["7376254", "60393"],
  ["7376326", "71413"],
  ["7376328", "71415"],
  ["7376330", "71417"],
  ["7376331", "71418"],
  ["7376287", "71783"],
  ["7376285", "71784"],
  ["7376286", "71785"],
  ["7376357", "71786"],
  ["7376264", "71787"],
  ["7376346", "76917"],
  ["7376356", "10985"],
  ["7376276", "10986"],
  ["7376262", "10990"],
  ["7376312", "10995"],
  ["7376289", "10996"],
  ["7376283", "41731"],
  ["7376271", "41732"],
  ["7376293", "43210"],
  ["7376256", "43211"],
  ["7376351", "43214"],
  ["7376307", "43216"],
  ["7376343", "75344"],
  ["7376344", "75345"],
  ["7376345", "75347"],
  ["7376332", "76241"],
  ["7376334", "76242"],
  ["7376335", "76243"],
  ["7376336", "76244"],
  ["7376337", "76245"],
  ["7376338", "76247"],
  ["7376339", "76248"],
  ["7376321", "75575"],
  ["7376322", "75576"],
  ["7376324", "75578"],
  ["7376325", "75579"],
  ["7376281", "41743"],
  ["7376352", "41806"],
  ["7388667", "71037"],
  ["7388667", "71037"],
  ["7405479", "10313"],
  ["7405534", "10314"],
  ["7405481", "11027"],
  ["7405482", "11028"],
  ["7405483", "11029"],
  ["7405484", "11030"],
  ["7405485", "31134"],
  ["7405486", "31135"],
  ["7405487", "31136"],
  ["7405488", "31137"],
  ["7405489", "31139"],
  ["7405490", "31140"],
  ["7405491", "41808"],
  ["7405492", "41809"],
  ["7405493", "41811"],
  ["7405494", "42153"],
  ["7405495", "42154"],
  ["7405496", "42155"],
  ["7405497", "60357"],
  ["7405498", "60359"],
  ["7405499", "60360"],
  ["7405500", "60361"],
  ["7405501", "76409"],
  ["7405502", "76410"],
  ["7405503", "76411"],
  ["7405504", "76412"],
  ["7405505", "76413"],
  ["7405506", "76420"],
  ["7405507", "76914"],
  ["7405508", "76915"],
  ["7405509", "76916"],
  ["7405510", "76918"],
  ["7405511", "10981"],
  ["7405512", "10982"],
  ["7405513", "10983"],
  ["7405514", "10984"],
  ["7405515", "10789"],
  ["7405516", "10790"],
  ["7405517", "10791"],
  ["7405518", "43219"],
  ["7405519", "43220"],
  ["7405520", "75349"],
  ["7405521", "75350"],
  ["7405522", "43212"],
  ["7405523", "43217"],
  ["7405524", "76253"],
  ["7405525", "76254"],
  ["7405526", "76255"],
  ["7405527", "42156"],
  ["7405528", "10993"],
  ["7405529", "43213"],
  ["7405530", "75346"],
  ["7405531", "75348"],
  ["7405532", "75352"],
  ["7405533", "75353"],
  ["7405480", "71038"],
  ["7405480", "71038"],
  // ["#N/D", "42146"],
  // ["#N/D", "41725"],
  // ["#N/D", "21247"],
  // ["#N/D", "21248"],
  // ["#N/D", "21249"],
  // ["#N/D", "21250"],
  // ["#N/D", "31141"],
  // ["#N/D", "31142"],
  // ["#N/D", "31209"],
  // ["#N/D", "31210"],
  // ["#N/D", "41734"],
  // ["#N/D", "41736"],
  // ["#N/D", "41737"],
  // ["#N/D", "41744"],
  // ["#N/D", "41745"],
  // ["#N/D", "41746"],
  // ["#N/D", "41747"],
  // ["#N/D", "41748"],
  // ["#N/D", "41749"],
  // ["#N/D", "41752"],
  // ["#N/D", "41753"],
  // ["#N/D", "41756"],
  // ["#N/D", "41758"],
  // ["#N/D", "42157"],
  // ["#N/D", "42158"],
  // ["#N/D", "42159"],
  // ["#N/D", "42160"],
  // ["#N/D", "42161"],
  // ["#N/D", "60362"],
  // ["#N/D", "60364"],
  // ["#N/D", "60365"],
  // ["#N/D", "60366"],
  // ["#N/D", "60367"],
  // ["#N/D", "60368"],
  // ["#N/D", "60376"],
  // ["#N/D", "60377"],
  // ["#N/D", "60379"],
  // ["#N/D", "60381"],
  // ["#N/D", "60391"],
  // ["#N/D", "71420"],
  // ["#N/D", "71421"],
  // ["#N/D", "71422"],
  // ["#N/D", "71423"],
  // ["#N/D", "71424"],
  // ["#N/D", "71425"],
  // ["#N/D", "71426"],
  // ["#N/D", "71777"],
  // ["#N/D", "71778"],
  // ["#N/D", "71779"],
  // ["#N/D", "71789"],
  // ["#N/D", "71790"],
  // ["#N/D", "71791"],
  // ["#N/D", "71792"],
  // ["#N/D", "71794"],
  // ["#N/D", "71796"],
  // ["#N/D", "71797"],
  // ["#N/D", "76414"],
  // ["#N/D", "76415"],
  // ["#N/D", "76416"],
  // ["#N/D", "76418"],
  // ["#N/D", "76419"],
  // ["#N/D", "10315"],
  // ["#N/D", "10987"],
  // ["#N/D", "10988"],
  // ["#N/D", "10989"],
  // ["#N/D", "10991"],
  // ["#N/D", "10992"],
  // ["#N/D", "10994"],
  // ["#N/D", "10997"],
  // ["#N/D", "21060"],
  // ["#N/D", "60363"],
  // ["#N/D", "71793"],
  // ["#N/D", "75366"],
  // ["#N/D", "10785"],
  // ["#N/D", "10786"],
  // ["#N/D", "10787"],
  // ["#N/D", "10788"],
  // ["#N/D", "43215"],
  // ["#N/D", "43218"],
  // ["#N/D", "43221"],
  // ["#N/D", "43223"],
  // ["#N/D", "43224"],
  // ["#N/D", "60380"],
  // ["#N/D", "76990"],
  // ["#N/D", "76991"],
  // ["#N/D", "76992"],
  // ["#N/D", "76993"],
  // ["#N/D", "76994"],
  // ["#N/D", "71453"],
  // ["#N/D", "71454"],
  // ["#N/D", "71455"],
  // ["#N/D", "71456"],
  // ["#N/D", "71457"],
  // ["#N/D", "71458"],
  // ["#N/D", "71459"],
  // ["#N/D", "71460"],
  // ["#N/D", "71461"],
  // ["#N/D", "71469"],
  // ["#N/D", "75358"],
  // ["#N/D", "75359"],
  // ["#N/D", "75360"],
  // ["#N/D", "75362"],
  // ["#N/D", "75363"],
  // ["#N/D", "75364"],
  // ["#N/D", "75365"],
  // ["#N/D", "76257"],
  // ["#N/D", "76258"],
  // ["#N/D", "76259"],
  // ["#N/D", "76260"],
  // ["#N/D", "76261"],
  // ["#N/D", "76262"],
  // ["#N/D", "76263"],
  // ["#N/D", "76264"],
  // ["#N/D", "76265"],
  // ["#N/D", "76267"],
  // ["#N/D", "76957"],
  // ["#N/D", "43230"],
  // ["#N/D", "43231"],
  // ["#N/D", "76421"],
  // ["#N/D", "41760"],
  // ["#N/D", "60398"],
  // ["#N/D", "75368"],
  // ["#N/D", "75369"],
  // ["#N/D", "75370"],
  // ["#N/D", "75371"],
  // ["#N/D", "76224"],
  // ["#N/D", "71039"],
  // ["#N/D", "71039"],
  // ["#N/D", "76958"],
  // ["#N/D", "76959"],
  // ["#N/D", "76960"],
  // ["#N/D", "76961"],
  ["7441362", "77012"],
  ["7441361", "77013"],
  ["7441360", "77015"],
  ["6213148", "10255"],
  ["6213153", "75192"],
  ["6411249", "71043"],
  ["6636742", "10265"],
  ["6636754", "21318"],
  ["6636743", "10266"],
  ["6636745", "10270"],
  ["6933262", "75290"],
  ["6868462", "71374"],
  ["6933268", "10273"],
  ["6933259", "10278"],
  ["6933264", "21325"],
  ["6933261", "10295"],
  ["6933260", "10283"],
  ["6933265", "21326"],
  ["6996844", "43197"],
  ["7083467", "21327"],
  ["7090421", "43203"],
  ["7090425", "75343"],
  ["7090424", "60336"],
  ["7292412", "21333"],
  ["7376292", "10303"],
  ["7376333", "76215"],
  ["7376348", "21246"],
  ["7376323", "75577"],
  ["7441347", "31138"],
  ["7441359", "76251"],
  ["7441362", "77012"],
  ["7441361", "77013"],
  ["7441360", "77015"],
  ["7481783", "21338"],
  // ["#N/D", "76958"],
  // ["#N/D", "42162"],
  // ["#N/D", "76959"],
  // ["#N/D", "76960"],
  // ["#N/D", "71795"],
  // ["#N/D", "21339"],
  // ["#N/D", "76423"],
  // ["#N/D", "76961"],
  // ["#N/D", "76249"],
  // ["#N/D", "21340"],
  // ["#N/D", "75355"],
  // ["#N/D", "76232"],
  // ["#N/D", "21342"],
];

const links = [];

async function get(url, index) {
  const currentdate = new Date();
  const datetime =
    currentdate.getHours() +
    ":" +
    currentdate.getMinutes() +
    ":" +
    currentdate.getSeconds();

  console.log(
    `Postęp: ${index + 1} z ${
      refs.length
    } | Błędy: ${errorsCount} | ${datetime}`
  );

  const client = new scrapingbee.ScrapingBeeClient(APIKEY);
  const res = await client.get({
    url: url,
    params: {
      block_ads: false,
      block_resources: true,
      country_code: "",
      device: "desktop",
      extract_rules: schema.promoklocki,
      json_response: false,
      js_scenario: {},
      premium_proxy: false,
      render_js: false,
      return_page_source: false,
      screenshot: false,
      screenshot_full_page: false,
      transparent_status_code: false,
      wait: 0,
      wait_for: "",
      window_width: 1920,
      window_height: 1080,
      timeout: 4000,
    },
    headers: {},
    cookies: {},
  });

  const decoder = new TextDecoder();
  const promoklocki = JSON.parse(decoder.decode(res.data));

  promoklocki["sku"] = refs[index][0];

  links.push(promoklocki);
}

async function getPlacesWithCoords(index) {
  if (index !== 0 && index === refs.length) {
    joinTabels();
    return false;
  }

  await get(`https://promoklocki.pl/?s=${refs[index][1]}`, index).catch((e) => {
    console.log("A problem occurs : " + e.message);
    refs.push([refs[index][0], refs[index][1]]);
    errorsCount++;
    // console.log(refs[index]);
    // console.log(refs[refs.length]);
    // console.log(refs[refs.length - 1]);
  });

  getPlacesWithCoords((index += 1));
}

function joinTabels() {
  let today = new Date().toISOString().slice(0, 10);

  fs.writeFile(
    `./linki_promoklocki_${today}.json`,
    JSON.stringify(links),
    (err) => {
      if (err) {
        console.error(err);
      }
      console.error("Zapisano plik");
    }
  );
}

getPlacesWithCoords((index = 0));
